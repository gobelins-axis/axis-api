!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).bundle={})}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var s=r(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return o(this,n)}}var d=["a","b","c"],a=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(r,e);var n=c(r);function r(){var e;return t(this,r),(e=n.call(this))._ipcRenderer=null,e._keys=d,e._mappedKeys=e._setupMappedKeys(),e._bindAll(),e._exposeMethods(),e._setupEventListeners(),e._setupIpcRendererEventListeners(),e}return i(r,[{key:"mappedKeys",get:function(){return this._mappedKeys}},{key:"destroy",value:function(){this._removeEventListeners(),this._removeIpcRendererEventListeners(),this._ipcRenderer=null}},{key:"registerKey",value:function(e,t){var n=this._keys.indexOf(e);if(-1!==n)return this._mappedKeys[this._keys[n]].keyboardKey=t,this._mappedKeys[this._keys[n]];console.error('Key with name "'.concat(e,'" is not available'))}},{key:"_setupMappedKeys",value:function(){for(var e={},t=0;t<this._keys.length;t++){var n=this._keys[t];e[n]={machineKey:n,keyboardKey:null,isPressed:!1}}return e}},{key:"_exposeMethods",value:function(){}},{key:"_setIpcRenderer",value:function(e){this._ipcRenderer||(this._ipcRenderer=e,this._setupIpcRendererEventListeners())}},{key:"_resetIpcRenderer",value:function(){this._removeIpcRendererEventListeners(),this._ipcRenderer=null}},{key:"_bindAll",value:function(){this._setIpcRenderer=this._setIpcRenderer.bind(this),this._resetIpcRenderer=this._resetIpcRenderer.bind(this),this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),this._machineKeydownHandler=this._machineKeydownHandler.bind(this),this._machineKeyupHandler=this._machineKeyupHandler.bind(this),this._joystickMoveHandler=this._joystickMoveHandler.bind(this)}},{key:"_setupEventListeners",value:function(){}},{key:"_setupIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.on("keydown",this._machineKeydownHandler),this._ipcRenderer.on("keyup",this._machineKeyupHandler),this._ipcRenderer.on("joystick:move",this._joystickMoveHandler),this._ipcRenderer.on("joystick:keydown",this._joystickKeydownHandler),this._ipcRenderer.on("joystick:keyup",this._joystickKeyupHandler))}},{key:"_removeIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.removeListener("keydown",this._machineKeydownHandler),this._ipcRenderer.removeListener("keyup",this._machineKeyupHandler),this._ipcRenderer.removeListener("joystick:move",this._joystickMoveHandler),this._ipcRenderer.removeListener("joystick:keydown",this._joystickKeydownHandler),this._ipcRenderer.removeListener("joystick:keyup",this._joystickKeyupHandler))}},{key:"_removeEventListeners",value:function(){window.removeEventListener("keydown",this._keydownHandler),window.removeEventListener("keyup",this._keyupHandler)}},{key:"_keydownHandler",value:function(e){for(var t in this._mappedKeys)this._mappedKeys[t].keyboardKey===e.key&&(this._mappedKeys[t].isPressed=!0,this.dispatchEvent("keydown",this._mappedKeys[t]))}},{key:"_keyupHandler",value:function(e){for(var t in this._mappedKeys)this._mappedKeys[t].keyboardKey===e.key&&(this._mappedKeys[t].isPressed=!1,this.dispatchEvent("keyup",this._mappedKeys[t]))}},{key:"_machineKeydownHandler",value:function(e,t){for(var n in this._mappedKeys)this._mappedKeys[n].machineKey===t&&(this._mappedKeys[n].isPressed=!0,this.dispatchEvent("keydown",this._mappedKeys[n]))}},{key:"_machineKeyupHandler",value:function(e,t){for(var n in this._mappedKeys)this._mappedKeys[n].machineKey===t&&(this._mappedKeys[n].isPressed=!1,this.dispatchEvent("keyup",this._mappedKeys[n]))}},{key:"_joystickMoveHandler",value:function(e,t){this.dispatchEvent("joystick:move",t)}},{key:"_joystickKeydownHandler",value:function(e,t){this.dispatchEvent("joystick:keydown",t)}},{key:"_joystickKeyupHandler",value:function(e,t){this.dispatchEvent("joystick:keyup",t)}}]),r}(function(){function e(){t(this,e)}return i(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}}},{key:"dispatchEvent",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n)for(var i=n.slice(0),r=0,s=i.length;r<s;r++)i[r].call(this,t)}}}]),e}()));e.Arcade=a,e.default=a,Object.defineProperty(e,"__esModule",{value:!0})}));
