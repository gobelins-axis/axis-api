!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).bundle={})}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s(e);if(t){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}var d=function(){function e(){t(this,e)}return i(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}}},{key:"dispatchEvent",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n)for(var i=n.slice(0),r=0,s=i.length;r<s;r++)i[r].call(this,t)}}}]),e}(),a={deadzone:.1},y=function(e){r(s,e);var n=u(s);function s(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(this,s),(e=n.call(this))._id=i.id,e._ipcRenderer=null,e._deadzone=a.deadzone,e}return i(s,[{key:"ipcRenderer",get:function(){return this._ipcRenderer},set:function(e){this._ipcRenderer=e}},{key:"deadzone",get:function(){return this._deadzone},set:function(e){this._deadzone=e}}]),s}(d),l=function(e){r(s,e);var n=u(s);function s(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(this,s),(e=n.call(this))._id=i.id,e._joystick=i.joystick,e._buttons=i.buttons,e}return i(s,[{key:"joystick",get:function(){return this._joystick},set:function(e){this._joystick=e}},{key:"buttons",get:function(){return this._buttons},set:function(e){this._buttons=e}}]),s}(d),h=function(){function e(){t(this,e),this._ipcRenderer=null,this._bindAll(),this._setupIpcRendererEventListeners()}return i(e,[{key:"ipcRenderer",get:function(){return this._ipcRenderer},set:function(e){this._ipcRenderer=e,this._setupIpcRendererEventListeners()}},{key:"destroy",value:function(){this._removeIpcRendererEventListeners()}},{key:"_bindAll",value:function(){this._joystickMoveHandler=this._joystickMoveHandler.bind(this)}},{key:"_setupIpcRendererEventListeners",value:function(){this._ipcRenderer&&this._ipcRenderer.on("joystick:move",this._joystickMoveHandler)}},{key:"_removeIpcRendererEventListeners",value:function(){this._ipcRenderer&&this._ipcRenderer.removeListener("joystick:move",this._joystickMoveHandler)}},{key:"_joystickMoveHandler",value:function(){}}]),e}(),_={buttons:[{key:"a",id:1},{key:"b",id:1},{key:"c",id:1},{key:"d",id:1},{key:"e",id:1},{key:"a",id:2},{key:"b",id:2},{key:"c",id:2},{key:"d",id:2},{key:"e",id:2}],joystick:a},f=function(e){r(s,e);var n=u(s);function s(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(this,s),(e=n.call(this))._id=i.id,e._key=i.key,e._keyboardKeys=[],e}return i(s,[{key:"id",get:function(){return this._id}},{key:"key",get:function(){return this._key}},{key:"keyboardKeys",get:function(){return this._keyboardKeys},set:function(e){this._keyboardKeys=e}},{key:"keydownHandler",value:function(e){this.dispatchEvent("keydown",e)}},{key:"keyupHandler",value:function(e){this.dispatchEvent("keyup",e)}}]),s}(d);var p=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._buttons=n.buttons,this._ipcRenderer=null,this._bindAll(),this._setupEventListeners()}return i(e,[{key:"ipcRenderer",get:function(){return this._ipcRenderer},set:function(e){this._ipcRenderer=e,this._setupIpcRendererEventListeners()}},{key:"destroy",value:function(){this._removeEventListeners(),this._removeIpcRendererEventListeners()}},{key:"registerKeys",value:function(e,t,n){var i,r=this.getButton(t,n);return r&&(r.keyboardKeys=(i=e,Array.isArray(i)?i:[i])),r}},{key:"getButton",value:function(e,t){return this._buttons.filter((function(n){return n.key===e&&n.id===t}))[0]}},{key:"getButtonsById",value:function(e){return this._buttons.filter((function(t){return t.id===e}))}},{key:"getButtonsByKeyboardKey",value:function(e){return this._buttons.filter((function(t){return t.keyboardKeys.includes(e)}))}},{key:"_bindAll",value:function(){this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),this._machineKeydownHandler=this._machineKeydownHandler.bind(this),this._machineKeyupHandler=this._machineKeyupHandler.bind(this)}},{key:"_setupEventListeners",value:function(){window.addEventListener("keydown",this._keydownHandler),window.addEventListener("keyup",this._keyupHandler)}},{key:"_removeEventListeners",value:function(){window.removeEventListener("keydown",this._keydownHandler),window.removeEventListener("keyup",this._keyupHandler)}},{key:"_setupIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.on("keydown",this._machineKeydownHandler),this._ipcRenderer.on("keyup",this._machineKeyupHandler))}},{key:"_removeIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.removeListener("keydown",this._machineKeydownHandler),this._ipcRenderer.removeListener("keyup",this._machineKeyupHandler))}},{key:"_keydownHandler",value:function(e){for(var t=this.getButtonsByKeyboardKey(e.key),n=0;n<t.length;n++)t[n].keydownHandler(e)}},{key:"_keyupHandler",value:function(e){for(var t=this.getButtonsByKeyboardKey(e.key),n=0;n<t.length;n++)t[n].keyupHandler(e)}},{key:"_machineKeydownHandler",value:function(e,t){}},{key:"_machineKeyupHandler",value:function(e,t){}}]),e}(),k=function(e){r(s,e);var n=u(s);function s(){var e;return t(this,s),(e=n.call(this))._ipcRenderer=null,e._joystick1=e._createJoystick1(),e._joystick2=e._createJoystick2(),e._joystickManager=e._createJoystickManager(),e._buttons=e._createButtons(),e._buttonManager=e._createButtonManager(),e._player1=e._createPlayer1(),e._player2=e._createPlayer2(),e._bindAll(),e._exposeMethods(),e._setupIpcRendererEventListeners(),e}return i(s,[{key:"mappedKeys",get:function(){return this._mappedKeys}},{key:"ipcRenderer",get:function(){return this._ipcRenderer}},{key:"joystick1",get:function(){return this._joystick1}},{key:"joystick2",get:function(){return this._joystick2}},{key:"player1",get:function(){return this._player1}},{key:"player2",get:function(){return this._player2}},{key:"start",value:function(){}},{key:"destroy",value:function(){this._removeIpcRendererEventListeners(),this._ipcRenderer=null}},{key:"registerKeys",value:function(e,t,n){return this._buttonManager.registerKeys(e,t,n)}},{key:"_exposeMethods",value:function(){window.__arcade__={},window.__arcade__.set_ipc_renderer=this._setIpcRenderer}},{key:"_setIpcRenderer",value:function(e){this._ipcRenderer||(this._ipcRenderer=e,this._setupIpcRendererEventListeners())}},{key:"_createJoystick1",value:function(){return new y({id:1})}},{key:"_createJoystick2",value:function(){return new y({id:2})}},{key:"_createJoystickManager",value:function(){return new h({joysticks:[this._joystick1,this._joystick2]})}},{key:"_createButtons",value:function(){for(var e=[],t=0;t<_.buttons.length;t++){var n=new f({id:_.buttons[t].id,key:_.buttons[t].key});e.push(n)}return e}},{key:"_createButtonManager",value:function(){return new p({buttons:this._buttons})}},{key:"_createPlayer1",value:function(){return new l({id:1,joystick:this._joystick1,buttons:this._buttonManager.getButtonsById(1)})}},{key:"_createPlayer2",value:function(){return new l({id:2,joystick:this._joystick2,buttons:this._buttonManager.getButtonsById(2)})}},{key:"_bindAll",value:function(){this._setIpcRenderer=this._setIpcRenderer.bind(this),this._machineExitAttemptHandler=this._machineExitAttemptHandler.bind(this),this._machineExitCanceledHandler=this._machineExitCanceledHandler.bind(this),this._machineExitCompletedHandler=this._machineExitCompletedHandler.bind(this)}},{key:"_setupIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.on("exit:attempted",this._machineExitAttemptHandler),this._ipcRenderer.on("exit:canceled",this._machineExitCanceledHandler),this._ipcRenderer.on("exit:completed",this._machineExitCompletedHandler))}},{key:"_removeIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.removeListener("exit:attempted",this._machineExitAttemptHandler),this._ipcRenderer.removeListener("exit:canceled",this._machineExitCanceledHandler),this._ipcRenderer.removeListener("exit:completed",this._machineExitCompletedHandler))}},{key:"_machineExitAttemptHandler",value:function(){this.dispatchEvent("exit:attempted")}},{key:"_machineExitCanceledHandler",value:function(){this.dispatchEvent("exit:canceled")}},{key:"_machineExitCompletedHandler",value:function(){this.dispatchEvent("exit:completed")}}]),s}(d),v=new k;e.Arcade=v,e.default=v,Object.defineProperty(e,"__esModule",{value:!0})}));
