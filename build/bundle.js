!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bundle=t()}(this,(function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return s(this,n)}}var d=["a","b"];return new(function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(s,t);var r=o(s);function s(){var t;return e(this,s),(t=r.call(this))._ipcRenderer=null,t._keys=d,t._mappedKeys=t._setupMappedKeys(),t._bindAll(),t._exposeMethods(),t._setupEventListeners(),t._setupIpcRendererEventListeners(),t}return n(s,[{key:"mappedKeys",get:function(){return this._mappedKeys}},{key:"destroy",value:function(){this._removeEventListeners(),this._removeIpcRendererEventListeners(),this._ipcRenderer=null}},{key:"registerKey",value:function(e,t){var n=this._keys.indexOf(e);if(-1!==n)return this._mappedKeys[this._keys[n]].keyboardKey=t,this._mappedKeys[this._keys[n]];console.error('Key with name "'.concat(e,'" is not available'))}},{key:"_setupMappedKeys",value:function(){for(var e={},t=0;t<this._keys.length;t++){var n=this._keys[t];e[n]={machineKey:n,keyboardKey:null,isPressed:!1}}return e}},{key:"_exposeMethods",value:function(){console.log("EXPOSE METHOD"),window.__arcade__={},window.__arcade__.set_ipc_renderer=this._setIpcRenderer,window.__arcade__.reset_ipc_renderer=this._resetIpcRenderer}},{key:"_setIpcRenderer",value:function(e){this._ipcRenderer||(this._ipcRenderer=e,this._setupIpcRendererEventListeners())}},{key:"_resetIpcRenderer",value:function(){this._removeIpcRendererEventListeners(),this._ipcRenderer=null}},{key:"_bindAll",value:function(){this._setIpcRenderer=this._setIpcRenderer.bind(this),this._resetIpcRenderer=this._resetIpcRenderer.bind(this),this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),this._machineKeydownHandler=this._machineKeydownHandler.bind(this),this._machineKeyupHandler=this._machineKeyupHandler.bind(this)}},{key:"_setupEventListeners",value:function(){window.addEventListener("keydown",this._keydownHandler),window.addEventListener("keyup",this._keyupHandler)}},{key:"_setupIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.on("keydown",this._machineKeydownHandler),this._ipcRenderer.on("keyup",this._machineKeyupHandler))}},{key:"_removeIpcRendererEventListeners",value:function(){this._ipcRenderer&&(this._ipcRenderer.removeListener("keydown",this._machineKeydownHandler),this._ipcRenderer.removeListener("keyup",this._machineKeyupHandler))}},{key:"_removeEventListeners",value:function(){window.removeEventListener("keydown",this._keydownHandler),window.removeEventListener("keyup",this._keyupHandler)}},{key:"_keydownHandler",value:function(e){for(var t in this._mappedKeys)this._mappedKeys[t].keyboardKey===e.key&&(this._mappedKeys[t].isPressed=!0,this.dispatchEvent("keydown",this._mappedKeys[t]))}},{key:"_keyupHandler",value:function(e){for(var t in this._mappedKeys)this._mappedKeys[t].keyboardKey===e.key&&(this._mappedKeys[t].isPressed=!1,this.dispatchEvent("keyup",this._mappedKeys[t]))}},{key:"_machineKeydownHandler",value:function(e,t){for(var n in this._mappedKeys)this._mappedKeys[n].machineKey===t&&(this._mappedKeys[n].isPressed=!0,this.dispatchEvent("keydown",this._mappedKeys[n]))}},{key:"_machineKeyupHandler",value:function(e,t){for(var n in this._mappedKeys)this._mappedKeys[n].machineKey===t&&(this._mappedKeys[n].isPressed=!1,this.dispatchEvent("keyup",this._mappedKeys[n]))}}]),s}(function(){function t(){e(this,t)}return n(t,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n)for(var r=n.slice(0),i=0,s=r.length;i<s;i++)r[i].call(this,t)}}}]),t}()))}));
